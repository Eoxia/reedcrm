window.reedcrm||(window.reedcrm={},window.reedcrm.scriptsLoaded=!1),window.reedcrm.scriptsLoaded||(window.reedcrm.init=function(){window.reedcrm.load_list_script()},window.reedcrm.load_list_script=function(){if(!window.reedcrm.scriptsLoaded){let e=void 0,o=void 0;for(e in window.reedcrm)for(o in window.reedcrm[e].init&&window.reedcrm[e].init(),window.reedcrm[e])window.reedcrm[e]&&window.reedcrm[e][o]&&window.reedcrm[e][o].init&&window.reedcrm[e][o].init();window.reedcrm.scriptsLoaded=!0}},window.reedcrm.refresh=function(){let e=void 0,o=void 0;for(e in window.reedcrm)for(o in window.reedcrm[e].refresh&&window.reedcrm[e].refresh(),window.reedcrm[e])window.reedcrm[e]&&window.reedcrm[e][o]&&window.reedcrm[e][o].refresh&&window.reedcrm[e][o].refresh()},$(document).ready(window.reedcrm.init)),window.reedcrm.address={},window.reedcrm.address.init=function(){window.reedcrm.address.event()},window.reedcrm.address.event=function(){$(document).on("click",'[name="favorite_address"]',window.reedcrm.address.toggleAddressFavorite)},window.reedcrm.address.toggleAddressFavorite=function(){var e=$(this).attr("value");let o=$(this);var n=window.saturne.toolbox.getToken();let i="?";document.URL.match(/\?/)&&(i="&"),$.ajax({url:document.URL+i+"action=toggle_favorite&contact_id="+e+"&token="+n,type:"POST",processData:!1,contentType:!1,success:function(){var e=$(".fas.fa-star");o.hasClass("far")&&(o.removeClass("far"),o.addClass("fas")),e.removeClass("fas").addClass("far")},error:function(){}})},window.reedcrm||(window.reedcrm={}),window.reedcrm.callnotifications={},window.reedcrm.callnotifications.init=function(){console.log("ReedCRM Call Notifications initialized"),window.reedcrm.callnotifications.config(),window.reedcrm.callnotifications.start()},window.reedcrm.callnotifications.config=function(){var e=document.getElementById("reedcrm-call-config");e?(window.reedcrm.callnotifications.frequency=parseInt(e.dataset.frequency)||60,window.reedcrm.callnotifications.autoOpen=parseInt(e.dataset.autoOpen)||0,window.reedcrm.callnotifications.openNewTab=parseInt(e.dataset.openNewTab)||1,window.reedcrm.callnotifications.checkUrl=e.dataset.checkUrl||"",window.reedcrm.callnotifications.trans={incomingCall:e.dataset.transIncomingCall||"Incoming Call",from:e.dataset.transFrom||"From",phone:e.dataset.transPhone||"Phone",email:e.dataset.transEmail||"Email",viewContact:e.dataset.transViewContact||"View Contact"}):(window.reedcrm.callnotifications.frequency=60,window.reedcrm.callnotifications.autoOpen=0,window.reedcrm.callnotifications.openNewTab=1,window.reedcrm.callnotifications.checkUrl="",window.reedcrm.callnotifications.trans={incomingCall:"Incoming Call",from:"From",phone:"Phone",email:"Email",viewContact:"View Contact"}),window.reedcrm.callnotifications.enabled=!0,window.reedcrm.callnotifications.interval=null},window.reedcrm.callnotifications.start=function(){window.reedcrm.callnotifications.checkUrl?setTimeout(function(){console.log("Starting ReedCRM call check with frequency: "+window.reedcrm.callnotifications.frequency+"s"),window.reedcrm.callnotifications.check(),window.reedcrm.callnotifications.interval=setInterval(window.reedcrm.callnotifications.check,1e3*window.reedcrm.callnotifications.frequency)},3e3):console.error("ReedCRM: No check URL configured for call notifications")},window.reedcrm.callnotifications.check=function(){window.reedcrm.callnotifications.enabled&&jQuery.ajax({url:window.reedcrm.callnotifications.checkUrl,type:"GET",dataType:"json",success:function(e){e&&0<e.length&&(console.log("Found "+e.length+" new call events"),jQuery.each(e,function(e,o){window.reedcrm.callnotifications.show(o)}))},error:function(e,o,n){console.error("Error checking call events:",n)}})},window.reedcrm.callnotifications.show=function(o){console.log("Showing call notification:",o);var e=window.reedcrm.callnotifications.trans,n="<strong>"+e.incomingCall+"</strong> : "+o.contact_name;o.caller&&(n+="<br>"+e.from+": "+o.caller),o.contact_phone&&(n+="<br>"+e.phone+": "+o.contact_phone),o.contact_email&&(n+="<br>"+e.email+": "+o.contact_email),n=n+'<br><br><button type="button" class="button" onclick="window.open(\''+o.url+"', '_blank')\">"+e.viewContact+"</button>",jQuery.jnotify(n,"success",!0,{sticky:!0,timeout:3e4}),window.reedcrm.callnotifications.autoOpen&&setTimeout(function(){var e=window.reedcrm.callnotifications.openNewTab?"_blank":"_self";window.open(o.url,e)},1e3)},window.reedcrm.callnotifications.enable=function(){window.reedcrm.callnotifications.enabled=!0,window.reedcrm.callnotifications.check(),window.reedcrm.callnotifications.interval=setInterval(window.reedcrm.callnotifications.check,1e3*window.reedcrm.callnotifications.frequency),console.log("ReedCRM call notifications enabled")},window.reedcrm.callnotifications.disable=function(){window.reedcrm.callnotifications.enabled=!1,window.reedcrm.callnotifications.interval&&clearInterval(window.reedcrm.callnotifications.interval),console.log("ReedCRM call notifications disabled")},jQuery(document).ready(function(){window.reedcrm.callnotifications.init()}),window.reedcrm||(window.reedcrm={}),window.reedcrm.eventpro={},window.reedcrm.eventpro.modalId="eventproCardModal",window.reedcrm.eventpro.refreshTriggered=!1,window.reedcrm.eventpro.init=function(){window.reedcrm.eventpro.event(),window.reedcrm.eventpro.modalCloseWatcher()},window.reedcrm.eventpro.injectIframeCSS=function(e){try{var o=e.contentDocument||e.contentWindow.document,n=o.getElementById("addeventform");if(n){Array.from(o.body.children).forEach(function(e){e.style.display="none"}),o.body.appendChild(n);for(var i=n.nextSibling;i;){var r=i,i=i.nextSibling;o.body.removeChild(r)}o.documentElement.classList.add("reedcrm-modal-iframe-html"),o.body.classList.add("reedcrm-modal-iframe-body"),n.classList.add("reedcrm-modal-iframe-form"),$(e).css("opacity","1"),void 0!==window.saturne&&window.saturne.loader?window.saturne.loader.remove($("#"+window.reedcrm.eventpro.modalId+"-loader")):$("#"+window.reedcrm.eventpro.modalId+"-loader").hide()}else console.log("addeventform not found")}catch(e){console.log("Could not inject CSS into iframe:",e)}},window.reedcrm.eventpro.refreshProjectRow=function(n){var e,i;n&&(e=window.location.href.split("&action=")[0].split("#")[0],(i=$('tr[data-rowid="'+n+'"]')).length)&&(i.css("opacity","0.5"),$.ajax({url:e,type:"GET",success:function(e){var o=$(e).find('tr[data-rowid="'+n+'"]');o.length&&i.length?i.fadeOut(200,function(){i.html(o.html()),i.css("opacity","1"),i.fadeIn(200)}):i.css("opacity","1")},error:function(){i.css("opacity","1")}}))},window.reedcrm.eventpro.modalCloseWatcher=function(){var o=!1;setInterval(function(){var e=$("#"+window.reedcrm.eventpro.modalId).hasClass("modal-active");o&&!e&&(window.reedcrm.eventpro.refreshTriggered=!1),o=e},200)},window.reedcrm.eventpro.event=function(){$(document).on("click",".reedcrm-modal-open",function(e){var i,o=$(this),n=o.attr("data-modal-url"),o=o.attr("data-project-id");n&&((i=$("#"+window.reedcrm.eventpro.modalId+"-iframe")).data("initial-url",n),i.data("project-id",o),i.data("loaded-once",!1),i.data("form-submitted",!1),i.off("load.reedcrm").on("load.reedcrm",function(){window.reedcrm.eventpro.injectIframeCSS(this);try{var e=this.contentDocument||this.contentWindow.document,o=(e.querySelectorAll("form").forEach(function(e){e.addEventListener("submit",function(){i.data("form-submitted",!0)},!0)}),e.querySelectorAll('a[href*="tab="]')),n=this;o.forEach(function(e){e.addEventListener("click",function(e){var o=$("#"+window.reedcrm.eventpro.modalId+"-loader");o.show().addClass("wpeo-loader"),void 0!==window.saturne&&window.saturne.loader&&window.saturne.loader.display(o),$(n).css("opacity","0")})})}catch(e){}}),i.off("load.reedcrm-submit").on("load.reedcrm-submit",function(){try{var e,o=i.data("loaded-once"),n=i.data("form-submitted");o&&n&&!window.reedcrm.eventpro.refreshTriggered&&(window.reedcrm.eventpro.refreshTriggered=!0,e=i.data("project-id"),setTimeout(function(){$("#"+window.reedcrm.eventpro.modalId).removeClass("modal-active"),window.reedcrm.eventpro.refreshProjectRow(e),i.data("form-submitted",!1)},300)),i.data("loaded-once",!0)}catch(e){}}),$("#"+window.reedcrm.eventpro.modalId).attr("data-project-id",o),i.css("opacity","0"),(o=$("#"+window.reedcrm.eventpro.modalId+"-loader")).show().addClass("wpeo-loader"),void 0!==window.saturne&&window.saturne.loader&&window.saturne.loader.display(o),i.attr("src",n),$("#"+window.reedcrm.eventpro.modalId).addClass("modal-active"))})},window.reedcrm.quickcreation={},window.reedcrm.quickcreation.latitude=null,window.reedcrm.quickcreation.longitude=null,window.reedcrm.quickcreation.init=function(){window.reedcrm.quickcreation.event()},window.reedcrm.quickcreation.event=function(){$(document).on("change","#upload-image",window.saturne.media.uploadImage),$(document).on("click",".image-validate",window.reedcrm.quickcreation.createImg),window.reedcrm.quickcreation.getCurrentPosition(),$(document).on("submit",".quickcreation-form",window.reedcrm.quickcreation.vibratePhone),$(document).on("input","#opp_percent",window.reedcrm.quickcreation.showOppPercentValue)},window.reedcrm.quickcreation.createImg=function(){var e=$(this).closest(".wpeo-modal").find("canvas")[0].toDataURL("image/jpeg"),o=window.saturne.toolbox.getToken(),n=window.saturne.toolbox.getQuerySeparator(document.URL),n=document.URL+n+"action=add_img&token="+o;$.ajax({url:n,type:"POST",processData:!1,contentType:"application/octet-stream",data:JSON.stringify({img:e}),success:function(e){$(".wpeo-modal").removeClass("modal-active"),$("#id-container .linked-medias-list").replaceWith($(e).find("#id-container .linked-medias-list"))},error:function(){}})},window.reedcrm.quickcreation.getCurrentPosition=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){window.reedcrm.quickcreation.latitude=e.coords.latitude,window.reedcrm.quickcreation.longitude=e.coords.longitude,$("#id-container #latitude").val(window.reedcrm.quickcreation.latitude),$("#id-container #longitude").val(window.reedcrm.quickcreation.longitude)},function(e){switch(e.code){case e.PERMISSION_DENIED:$("#id-container #geolocation-error").val("User denied the request for geolocation.");break;case e.POSITION_UNAVAILABLE:$("#id-container #geolocation-error").val("Location information is unavailable.");break;case e.TIMEOUT:$("#id-container #geolocation-error").val("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:$("#id-container #geolocation-error").val("An unknown error occurred.")}}):$("#id-container #geolocation-error").val("Geolocation is not supported by this browser.")},window.reedcrm.quickcreation.vibratePhone=function(){"vibrate"in navigator&&navigator.vibrate([1e3,500,200,200,500,1e3]),window.saturne.loader.display($(".page-footer button"))},window.reedcrm.quickcreation.showOppPercentValue=function(){$(".opp_percent-value").text($("#opp_percent").val()+" %")},window.reedcrm.quickevent={},window.reedcrm.quickevent.init=function(){window.reedcrm.quickevent.event()},window.reedcrm.quickevent.event=function(){$(document).on("keyup","#label",window.reedcrm.quickevent.labelKeyUp)},window.reedcrm.quickevent.labelKeyUp=function(){$("#label").val().length>=.7*parseInt($("#label").attr("maxlength"))?$(".quickevent-label-warning-notice").removeClass("hidden"):$(".quickevent-label-warning-notice").addClass("hidden")};